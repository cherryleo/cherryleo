#### Allocs
Borg alloc（分配的简称）是机器上的一组保留资源，其中可以运行一个或多个任务;无论是否使用资源，资源仍然分配。Allocs可用于为未来任务设置资源，在停止任务和再次启动任务之间保留资源，以及将来自不同作业的任务收集到同一台机器上 - 例如，Web服务器实例和相关的logaver将服务器的URL日志从本地磁盘复制到分布式文件系统的任务。alloc的资源以与机器资源类似的方式处理;在一个内部运行的多个任务共享其资源。如果必须将alloc重定位到另一台计算机，则会使用它重新安排其任务。alloc set就像一个job：它是一组在多台机器上保留资源的alloc。一旦创建了一个alloc set，就可以提交一个或多个作业来运行它。为简洁起见，我们通常使用“任务”来引用alloc或顶级任务（一个在alloc之外）和“job”来引用一个job或alloc set。

#### Priority, quota, and admission control
当更多的工作出现而不是可以接受时会发生什么？我们的解决方案是优先级和配额。每个工作都有一个优先级，一个小的正整数。高优先级任务可以以较低优先级的任务为代价获得资源，即使这涉及抢占（杀死）后者。Borg为不同的用途定义了不重叠的优先级频段，包括（按递减优先级顺序）：监控，生产，批量和尽力而为（也称为测试或免费）。在本文中，prod工作是监控和生产领域的工作。虽然抢占的任务通常会在单元格的其他位置重新安排，但如果高优先级任务突然出现稍低优先级的任务，则会发生抢占级联，这会导致另一个稍低优先级的任务，等等。为了消除大部分这一点，我们不允许生产优先级带中的任务相互抢占。细粒度的优先级在其他情况下仍然有用 - 例如，MapReduce主任务的运行优先级高于他们控制的工作人员，以提高其可靠性。优先级表示正在运行或等待在单元中运行的作业的相对重要性。配额用于决定允许调度的作业。配额表示为给定优先级的资源数量（CPU，RAM，磁盘等）的向量，持续一段时间（通常为几个月）。数量指定用户的作业请求一次可以请求的最大资源量（例如，“从现在到7月底在单元格xx中的prod优先级的20TiB RAM”）。配额检查是准入控制的一部分，而非计划：配额不足的工作在提交时立即被拒绝。较高优先级的配额成本高于低优先级的配额。生产优先级配额仅限于单元中可用的实际资源，因此提交适合其配额的生产优先级作业的用户可以预期它将运行，模块化碎片和约束。即使我们鼓励用户购买的配额不超过他们的需求，但许多用户过度购买，因为它可以在应用程序的用户群增长时将其与未来的短缺隔离开来。我们通过在较低优先级别过度销售配额来回应这一点：每个用户都有优先级为零的无限配额，尽管由于资源超额认购而经常难以行使。可以接受低优先级的工作，但由于资源不足，仍然待定（未计划）。配额分配在Borg之外处理，并且与我们的物理容量规划密切相关，其结果反映在不同数据中心的配额价格和可用性中。只有在具有所需优先级的足够配额时才允许用户作业。配额的使用减少了对主导资源公平（DRF）等政策的需求[29,35,36,66]。Borg有一个能力系统，为一些用户提供特殊权限;例如，允许管理员删除或修改单元中的任何作业，或允许用户访问受限制的内核功能或Borg行为，例如禁用其作业的资源估算（第5.5节）。

#### Naming and monitoring
创建和放置任务是不够的：服务的客户端和其他系统需要能够找到它们，即使它们被重新定位到新机器之后也是如此。为了实现这一点，Borg为每个任务创建了一个稳定的“Borg名称服务”（BNS）名称，其中包括单元名称，作业名称和任务编号。Borg将任务的主机名和端口写入Chubby [14]中具有此名称的一致，高可用性文件，我们的RPC系统使用该文件来查找任务端点。BNS名称也构成了任务DNS名称的基础，因此可以通过50.jfoo.ubar.cc.borg.google.com访问单元cc中用户ubar拥有的作业jfoo中的第50个任务。无论何时更改，Borg还会将作业大小和任务运行状况信息写入Chubby，因此负载均衡器可以查看将请求路由到何处。

几乎在Borg下运行的每个任务都包含一个内置的HTTP服务器，它发布有关任务健康状况和数千个性能指标（例如RPC延迟）的信息。Borg监视运行状况检查URL并重新启动未及时响应的任务或返回HTTP错误代码。其他数据由仪表板监控工具和服务级别目标（SLO）违规警报跟踪。一项名为Sigma的服务提供了一个基于Web的用户界面（UI），用户可以通过该界面检查所有作业，特定单元格的状态，或深入查看各个作业和任务，以检查其资源行为，详细日志，执行历史，最终的命运。我们的应用程序可生成大量原木;它们会自动旋转以避免磁盘空间不足，并在任务退出后保留一段时间以协助调试。如果作业没有运行，Borg会提供“为什么要挂起？”注释，以及如何修改作业资源请求以更好地适应单元格的指导。我们发布了“符合”可能容易安排的资源形状的指南。Borg记录了所有作业提交和任务事件，以及Infrastore中的详细的每任务资源使用信息，Infrastore是一个可扩展的只读数据存储，通过Dremel [61]具有交互式SQL类接口。此数据用于基于使用情况的计费，调试作业和系统故障以及长期容量规划。它还为Google集群工作负载跟踪[80]提供了数据。所有这些功能都可以帮助用户理解和调试Borg及其工作的行为，并帮助我们的SRE管理每人数万台机器。